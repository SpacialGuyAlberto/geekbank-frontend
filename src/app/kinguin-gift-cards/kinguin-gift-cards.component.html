<!-- Paginación Angular Material (Superior) -->
<div class="pagination-container" *ngIf="isSearchMode">
  <mat-paginator
    [length]="totalItems"
    [pageSize]="itemsPerPage"
    [pageSizeOptions]="[5, 10, 20, 50]"
    (page)="onPageChange($event)">
  </mat-paginator>
</div>


<div *ngIf="!isSearchMode">
  @for (classification of classificationList; track classification.valueOf()) {
    <div
      [ngClass]="{
        'gift-cards-container': !isSearchMode,
        'gift-cards-container-search': isSearchMode
      }">

      @for (card of giftCardsByClass.get(classification) ?? []; track card.productId) {
        <div class="gift-card" (click)="viewDetails(card)">
          <div class="image-container">
            <img class="gift-card-image"
                 [src]="card.coverImageOriginal"
                 alt="{{ card.name }}">
          </div>

          <div class="gift-card-content">
              <span class="discount-percentage">
                {{ card.randomDiscount }}% OFF
              </span>

            <h3 class="gift-card-title">{{ card.name }}</h3>
            <span class="platform">{{ card.platform }}</span>

            <div class="gift-card-price">
                <span class="original-price">
                  {{
                    card.price | convertToHnl: exchangeRate
                      | autogenerateDiscount: card.name
                      | currency:'HNL':'symbol':'1.2-2'
                  }}
                </span>
              <span class="discounted-price">
                  {{ card.price | convertToHnl: exchangeRate
                | currency:'HNL':'symbol':'1.2-2' }}
                </span>
            </div>
          </div>
        </div>
      }
    </div>
  }
</div>

<div
  [ngClass]="{
    'gift-cards-container': !isSearchMode,
    'gift-cards-container-search': isSearchMode
  }">
  <div *ngIf="isLoading && isSearchMode" class="loading-indicator">
    <div class="bars">
      <div class="bar bar1"></div>
      <div class="bar bar2"></div>
      <div class="bar bar3"></div>
      <div class="bar bar4"></div>
      <div class="bar bar5"></div>
    </div>
  </div>
  <div
    *ngFor="let card of displayedGiftCards"
    [ngClass]="{
      'gift-card': !isSearchMode,
      'gift-card-search': isSearchMode
    }"
    (click)="viewDetails(card)">

    <div
      [ngClass]="{
        'image-container': !isSearchMode,
        'image-container-search': isSearchMode
      }">
      <img
        [src]="card.coverImageOriginal"
        alt="{{ card.name }}"
        [ngClass]="{
          'gift-card-image': !isSearchMode,
          'gift-card-image-search': isSearchMode
        }">
    </div>

    <div
      [ngClass]="{
        'gift-card-content': !isSearchMode,
        'gift-card-content-search': isSearchMode
      }">
      <!-- Span de Descuento -->
      <span
        [ngClass]="{
          'discount-percentage': !isSearchMode,
          'discount-percentage-search': isSearchMode
        }">
        {{ card.randomDiscount }}% OFF
      </span>

      <!-- Título de la Gift Card -->
      <h3
        [ngClass]="{
          'gift-card-title': !isSearchMode,
          'gift-card-title-search': isSearchMode
        }">
        {{ card.name }}
      </h3>
      <span
        [ngClass]="{
          'platform': !isSearchMode,
          'platform-search': isSearchMode
        }">
        {{ card.platform }}
      </span>
      <div
        [ngClass]="{
          'gift-card-price': !isSearchMode,
          'gift-card-price-search': isSearchMode
        }">
        <span
          [ngClass]="{
            'original-price': !isSearchMode,
            'original-price-search': isSearchMode
          }">
          {{
             card.price  | convertToHnl: exchangeRate | autogenerateDiscount: card.name  | currency:'HNL':'symbol':'1.2-2'
          }}
        </span>
        <span
          [ngClass]="{
            'discounted-price': !isSearchMode,
            'discounted-price-search': isSearchMode
          }">
          {{ card.price | convertToHnl: exchangeRate | currency:'HNL':'symbol':'1.2-2' }}
        </span>
      </div>
    </div>
  </div>
</div>

<div class="pagination-container" *ngIf="!isSearchMode && totalPagesMain > 1">
  <mat-paginator
    #mainPaginator
    [length]="totalItemsMain"
    [pageSize]="pageSizeMain"
    [pageIndex]="currentPageMain"
    [pageSizeOptions]="[5, 10, 20, 50]"
    (page)="onPageChangeMain($event)"

  >
  </mat-paginator>
</div>
<div class="pagination-container" *ngIf="isSearchMode && totalPages > 0">
  <mat-paginator
    [length]="totalItems"
    [pageSize]="itemsPerPage"
    [pageSizeOptions]="[5, 10, 20, 50]"
    (page)="onPageChange($event)">
  </mat-paginator>
</div>
