<!-- Banner dinámico en el background (blur y z-index negativo) -->
<div
  class="genre-banner"
  *ngIf="bannerImage"
  [ngStyle]="{'background-image': 'url(' + bannerImage + ')'}">
</div>

<div class="filtered-page-container">
  <header class="filtered-page-header">
    <!-- Muestra el género en pantalla -->
    <h1>{{ selectedCategory }}</h1>
  </header>

  <section class="filtered-page-content">
    <!-- Indicador de carga principal -->
    <div *ngIf="isLoading" class="loading-indicator">
      <div class="spinner"></div>
    </div>

    <!-- Mensaje de error -->
    <div *ngIf="errorMessage" class="error-message">
      <p>{{ errorMessage }}</p>
    </div>

    <!-- Tarjetas de gift cards -->
    <div *ngIf="!isLoading && giftCards.length > 0" class="cards-wrapper">
      <div
        *ngFor="let card of giftCards"
        class="gift-card"
        (click)="viewDetails(card)"
      >
        <div class="image-container">
          <img
            [src]="card.coverImageOriginal"
            alt="{{ card.name }}"
            class="gift-card-image"
          />
        </div>

        <div class="gift-card-content">
          <!-- Mostrar el descuento dinámico -->
          <span class="discount-percentage">
            {{ card.randomDiscount }}% OFF
          </span>

          <h3 class="gift-card-title">{{ card.name }}</h3>
          <span class="platform">{{ card.platform }}</span>

          <div class="gift-card-price">
            <!-- Precio original calculado -->
            <span class="original-price">
              {{
                card.price  | convertToHnl: exchangeRate | autogenerateDiscount: card.name  | currency:'HNL':'symbol':'1.2-2'
              }}
            </span>
            <!-- Precio con descuento -->
            <span class="discounted-price">
               {{ card.price | convertToHnl: exchangeRate | currency:'HNL':'symbol':'1.2-2' }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Mensaje cuando no hay gift cards -->
    <div
      *ngIf="!isLoading && giftCards.length === 0 && !errorMessage"
      class="no-data-message"
    >
      <p>No hay gift cards disponibles para esta categoría.</p>
    </div>

    <!-- Botón para cargar más gift cards -->
    <div
      *ngIf="hasMore && !isLoading && giftCards.length > 0"
      class="load-more-container"
    >
      <button
        class="load-more-button"
        (click)="loadMore()"
        [disabled]="isLoadingMore"
      >
        <ng-container *ngIf="!isLoadingMore">
          Cargar más
        </ng-container>
        <ng-container *ngIf="isLoadingMore">
          <div class="button-spinner"></div>
          Cargando...
        </ng-container>
      </button>
    </div>
  </section>
</div>
